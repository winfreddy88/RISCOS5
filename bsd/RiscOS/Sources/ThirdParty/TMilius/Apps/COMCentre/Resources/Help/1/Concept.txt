Sorry for the German parts in this document. Translation is doen step by step.

!COMCentre maintains a couple of informations between the drivers of some
communication devices and the applications located above them.

!COMCentre provides everthing within variables or aliases

Verwendung
----------

Jedes neue Device sollte sich über

COMCentre_register PseudoHexVendorId PseudoHexProductId [ignored [ignored ...]]

registrieren. Das Kommando legt die Registrierung in der Variablen

COMCentre$NEW_PseudoHexVendorId_PseudoHexProductId

ab und bearbeitet alle Registrierungen sobald Zeit dafür ist.

Dazu wird für jede Registrierung in COMCentre$Dir.Devices nach einem
entsprechenden Command-File mit dem Namen
PseudoHexVendorId_PseudoHexProductId geschaut. Existiert dies so wird die
Obey-Datei ausgeführt. Sie setzt die entsprechenden Aliase und startet bei
bei Bedarf die entprechenden Applikation etc.

PseudoIds
---------

Es werden die USB Vendor/ProductIds in hexadezimaler Angabe verwendet. Um auch
serielle Interfaces und Netzwerke prinzipiell darin unterbringen zu können, kommen
folgende Namensschemata zur Anwendung, wobei die Limitierungen der hexadezimalen Schreibweise
ausgenutzt werden:

Syyy-zxxx - Für serielle Ports des OS. xxx ist die Portnummer. yyy ist bei den
            Rechnerstandardports gleich ROS.
            z steht für den Typ des angeschlossenen Gerätes:
            M - Modem
I000-0000 - Für alles was über das Netzwerk erreichbar ist (Internet per DSL,
            Voice over IP)

bei USB-Seriell-Adaptern sind die USB-Daten zu verwenden.

Bluestooth beginnt vorne mit beim Vendor mit T.

Grundkonzept
------------

COMCentre stellt die Information in Form von Variablen oder Aliasen bereit.
Aliase kommen bei Operationen zum Einsatz, die ein Treiber oder eine Applikation
mit Parametern ausführt, wenn sie gebraucht werden. Die dahinterstehenden Kommandos
geben Textoutput zurück. Sie können als Subtask im taskwindowmodus ausgeführt
werden und führen eine bestimmte normierte Funktion aus.

Zur Ausführung von Operation können sich Programme informieren lassen. Solche
Benachrichtigungen kommen auch bei bestimmten asynchronen Eregnissen zum Einsatz.
Die Programm müssen solche Aliase setzen und können darauf vertrauen, daß Sie von
bestimmten Operation unterstützt werden.

Information bzw. Operationen können von verschiedenen Geräten parallel, d.h.
mehrfach zur Verfügung gestellt werden. Dazu werden die Informationen bereitgestellt
welche Operation für welche Geräteklasse vorhanden ist und innerhalb einer
Geräteklasse werden die Operationen eindeutig gekennzeichnet. Typischerweise
kommt hierzu eine PseudoID-Kombination aber ohne ”_” zur Anwendung.

Für jede Operation kann, muß aber nicht, eine Variable der Form

COMCentre$LINE_Type_OP_Op-Group_I_PREFERRED

bereitstellen, in der die bevorzugt zu nutzende Type_Tag Kombination hinterlegt ist.

Jede nutztbare Funktion wird durch Variablen der Form

COMCentre$[LINE_Type_ID_]OP_Op-Group_I_AVAILABLE

angezeigt, wobei die Variable verfügbare Ausprägungen der Operation als Inhalt
darstellt und niemals leer sein sollte.

Programme, die bestimmte Oprationen unterstützen, sollten diese Variablen alle
scannen und eine Liste der verfügbaren Geräte zur Auswahl anbieten, sofern kein
bestimmtes Gerät vorgegeben wird. Ist nur ein Gerät für eine Operation verfügbar,
wird automatisch dieses Gerät gewählt.

Durch Setzen einer Variable mit einem Wert (i.d.R. Y) wird pro Op-Group angezeigt,
ob eine Op-Group exklusiv genutzt wird:

COMCentre$LINE_Type_ID_OP_Op-Group_I_BUSY

Manche Funktionen müssen initialisiert werden. Aus Geschwindigkeitsgründen kann dann eine
Variable

COMCentre$LINE_Type_ID_OP_Op-Group_I_INITIALIZED

nach der Initialisierung auf Y gestezt werden. Wird das Gerät in dem betreffenden Bereich
durch andere Programme umkonfiguriert, sollte man die entsprechende Variable löschen.


Types
-----

Die Types geben die Geräteart an. Sie erlauben eine bestimmte Priorisierung, d.h.
eine Auswahl, welche Operation, wo abgerufen wird.

NET    - Netzwerk
MODEM  - Klassisches Modem
MMODEM - Mobilfunk Modem (USB UMTS/GSM Surfstick)
ISDN   - ISDN Modem

Op-Group
--------

Operationen die auf einem Gerät durchgeführt werden können:

MODEM     - Gerät kann als Modem mit AT-Kommandos o.Ä. angesprochen werden
INET      - Gerät stellt Internetverbindung bereit
PHONE     - Gerät stellt ein Telefon bereit
SMS       - Gerät erlaubt Versenden und Empfangen von SMS-Nachrichten
FAX       - Gerät erlaubt Versenden und Empfangen von FAXen
REMOTE    - Gerät erlaubt Remote-Operationen, wozu auch ein Anrufbeantworter
            zählt
CALLBOX   - Anrufbeantworter im Gerät. Zum Festlegen von Antworttext und abrufen
            der Nachrichten
PROTECT   - Gerät muß entsperrt werden.
DEVNUMBER - Gerät hat eigene Telefonnummernliste
NET       - Gerät benötigt Netzzugang
NUMBER    - Zentrale Nummernverwaltung (Keine LINE)
PRESENCE  - Gerät auf Störung prüfen.
CONFIG    - Gerät konfigurieren
USSD      - Gerät unterstützt Unstructured Supplenmentary Service Data

Operationsaktionen
------------------

Werden immer als Aliase bereitgestellt. Diese Werte sind in den zu übergebenden
Parametern genormt. Sie werden normalerweise von den Treibern gesetzt. Zu bestimmten
Operationen und Ereignissen gibt Aliase, die ausgeführt werden, wenn eine Operation
ausgeführt wird oder ein asynchrones Ereigniss auftritt. Diese Aliase sind von den
jeweiligen Programmen zu setzen.

Die Operations-Aliase haben die Form

Alias$COMCentre_[LINE_Type_Id_]OP_Op-Group_O_Op-Action

Die Lineinformation entfällt bei bestimmten Op-Groups.

Die zugehörigen Benachrichtigungen haben die Form

Alias$COMCentre_[LINE_Type_Id_][OP_Op-Group_]O_Op-Action_CB_TaskId

wobei die TaskId der Name der zu informierenden Applikation sein sollte. Wird
die Lineinformation weggelassen, so erfolgt die Benachrichtigung unabhängig
von der jeweiligen Verbindung. Das gleiche gilt für die Op-Group. Eins von
beiden muß aber mindestens angegeben sein.

Pro Aktion gibt es Fehlervariable, die die aufrufende Applikation löschen darf
und die die leistende Applikation am Ende des Aufrufs oder während des Aufrufs
setzt. Diese Variablen haben folgendes Format:

COMCentre$LINE_Type_Id_OP_Op-Group_R_Op-Action

Am Anfang in der Variable stehen Stati, dann hinter einem : Informationen.

MODEM:

Z.Z. keine Aktionen definiert. Die Applikation benötigt nur Zugriffsdaten.

INET:

Action       Parameter      P Meaning
------       -------------- - -------
CONNECT      Type_Id        D Initiiert Internetverbindung
DISCONNECT   Type_Id        D Beendet Internetverbindung
DISCONNECT   Type_Id        A Ereigniss bei Beendigung der Verbindung
                              Auch durch Gegenseite

PHONE:

Action       Parameter      P Meaning
------       -------------- - -------
CONNECT      Type_Id        D Initiiert Telefonverbindung
             Nummer
             File/Sound Out
             File/Sound In
DIAL         Type_Id        D Tonwahl während einer Verbindung oder zum Aufbau
             Nummer           einer klassischen Verbindung ohne Computer
ACCEPT       Type_Id        D Annahme eines Anrufs
             TaskId           (initiert ACCEPT Ereigniss unabhängig von Operation)
             File/Sound Out
             File/Sound In
ACCEPT       Type_Id        A Ereigniss Annahme eines Anrufs
             TaskId
DISCONNECT   Type_Id        D Beendet Telefonverbindung
DISCONNECT   Type_Id        A Ereigniss bei Beendigung der Verbindung
                              Auch durch Gegenseite
RING         Type_Id        A Ereigniss bei ankommendem Ruf
             [-c Nummer]

SMS:

Action       Parameter      P Meaning
------       -------------- - -------
INITIALIZE   Type_Id        D Initialisiert die SMS-Einstellungen im Gerät auch gemäß
                              Konfiguration
SEND         Type_Id        D Versendet eine in einer Datei hinterlegte SMS
             Nummer           an eine angegebene Nummer
             File
FETCH        Type_Id        D Schreibt eine SMS in eine angegebene Datei
             int. Nummer      Format:
             File             Tag: Content
                              Sender: N/T Sender. N means it is number to which you can reply
                              Caller: N/T Caller. N means it is number to which you can reply
                              Time: DD.MM.YYYY HH:MM:SS GMT Offset_in_hours_with_fraction
DELETE       Type_Id        D Löscht eine SMS an der internen Nummer
             int. Nummer
ARRIVE       Type_Id        A SMS ist eingegangen mit Speicher- und Positionsangabe.
             Mem-Type
             int. Nummer

FAX:

Action       Parameter      P Meaning
------       -------------- - -------
CONNECT      Type_Id        D Initiiert FAX-Versand.
             Nummer           Die Applikation kümmert sich um den Versand im Detail.
                              Die Device-Opens werden aus den Variablen übernommen.
ACCEPT       Type_Id        D Annahme einer FAX-Verbindung
             TaskId           (initiert ACCEPT Ereigniss unabhängig von Operation)
ACCEPT       Type_Id        A Ereigniss Annahme einer FAX-Verbindung
             TaskId
DISCONNECT   Type_Id        D Beendet FAX-Verbindung
DISCONNECT   Type_Id        A Ereigniss bei Beendigung der Verbindung
                              Auch durch Gegenseite
RING         Type_Id        A Ereigniss bei ankommendem Ruf
             [-c Nummer]

REMOTE:

Action       Parameter      P Meaning
------       -------------- - -------
CONNECT      Type_Id        D Initiiert Telefonverbindung
             Nummer
             File/Sound Out
             File/Sound In
DIAL         Type_Id        D Tonwahl während einer Verbindung
             Nummer
DIALED       Type_Id        A Tonwahl während einer Verbindung durch Gegenstelle
             Nummer
ACCEPT       Type_Id        D Annahme eines Anrufs
             TaskId           (initiert ACCEPT Ereigniss unabhängig von Operation)
             File/Sound Out
             File/Sound In
ACCEPT       Type_Id        A Ereigniss Annahme eines Anrufs
             TaskId
DISCONNECT   Type_Id        D Beendet Telefonverbindung
DISCONNECT   Type_Id        A Ereigniss bei Beendigung der Verbindung
                              Auch durch Gegenseite
RING         Type_Id        A Ereigniss bei ankommendem Ruf
             [-c Nummer]

CALLBOX:

Action       Parameter      P Meaning
------       -------------- - -------
???

PROTECT:

Action       Parameter      P Meaning
------       -------------- - -------
UNPROTECT    Type_Id        D Stellt sicher, daß das Gerät entsperrt wird

DEVNUMBER:

Action       Parameter      P Meaning
------       -------------- - -------
LIST         Type_Id        D Liefert List mit allen Nummern in File
             File             Format:
             [-m MemType]     1. Zeile: "I", MinPosition, MaxPosition, MemType
                              Dann:     "N", Position, "Name","Nummer"
STORE        Type_Id        D Ändert Eintrag
             Position         Werden Name und Nummer weggelassen, bedeutet dies
             [Name            Löschen des Eintrags
              Nummer]
             [-m MemType]

NET:

Action       Parameter      P Meaning
------       -------------- - -------
INITIALIZE   Type_Id        D Initialisiert die Netz-Einstellungen im Gerät
ENSURE       Type_Id        D Versucht ein Netz bereitzustellen (<> Internetzugang)!.
             [-r]             Wenn -r angegeben, dann Fremdnetzzugriff erlaubt.
                              Evt. wird man gegen Fremdnetz verbunden, aber besondere
                              Operationen werden dann gesperrt, so daß es nicht
                              zu teuer wird.
LIST         Type_Id        D Liefert alle verfügbaren Netze in Datei.
             File             Die Datei kann leer sein.
                              Format:
                              availibility,net name long, net name short, net id, net type
                              availibility:
                               0 - unknown
                               1 - available
                               2 - used
                               3 - forbidden
                              net type:
                              -1 - unknown
                               0 - GPRS
                               2 - UMTS
CHANGED      Type_Id        A Ereigniss wenn Verbindung wechselt.
             Type             Typ:
             [Netlocation     0 - unknown
              Cell]           1 - not connected
                              2 - Home
                              3 - Roaming

NUMBER:

Hat keinen LINE-Bezug!

Action       Parameter      P Meaning
------       -------------- - -------
PROVIDE      Nummer         D stellt über eine Message eine Nummer an alle, die
             [-u Bevorzugte   sie haben wollen, bereit. Füllt außerdem Variable
             Verwendung       COMCentre$OP_NUMBER_O_PROVIDE_I_NUMBER.
             (PHONE, FAX,
              SMS)]
PROVIDE      Nummer         A Ereignis, wenn Nummer bereitgestellt wurde.
             [-u Bevorzugte
             Verwendung]

PRESENCE:

Action       Parameter      P Meaning
------       -------------- - -------
CHECK        Type_Id        D Prüft, ob das Device noch existiert. Wenn nein,
                              dann werden die Einträge in COMCentre entfernt
                              und ggf. Applikationen benachrichtigt.
                              ACHTUNG: Wenn Device nicht existiert wird keine
                              Ergebnisvariable zurückgegeben!
GONE         Type_Id        A Ereigniss, wenn Gerät nicht mehr existiert.

CONFIG:

Action       Parameter      P Meaning
------       -------------- - -------
INITIALIZE   Type_Id        D Initialisiert Gerät

USSD:

Action       Parameter      P Meaning
------       -------------- - ---------
SEND         Type_Id        D Sendet eine Anwort oder initiert eine Anfrage
             Antwortart       0 - Fertig
                              1 - Neue Sitzung
                              2 - Cancel
             [Antwort]        Anwort Zeichenkette in ASCII
REPLY        Type_Id        A Ereigniss, wenn Anwort empfangen wurde
             Antwortart       0 - Fertig
                              1 - Anfrage Provider
                              2 - Cancel
             [Antwort]        Antwort Zeichenkette in ASCII

Konfigurationsparameter
-----------------------

Parameter    Meaning
---------    -------
Resolvers    Liste der DNS-Resolver, die bei Verbindungsaufbau zu setzen sind.
Roaming      Y. Erlaubt Verwendung von Fremdnetzen.
Tarif        Name des Zugangtarifs
InetProvider Inetwahl bei GSM/UMTS

Variablen
---------

COMCentre$ScrapDir - Verzeichnis im dem CONCentre temporäre dateien ablegt.
COMCentre$Setup    - intern. Semaphor während Registrierung.
COMCentre$NEW_PseudoHexVendorID_PseudoHexProductID - intern. Für Registrierung

COMCentre$LINE_Type_Id_IN_VENDOR       - Hersteller zur Implementierung von
                                         herstellerspezifischen Protokollen
COMCentre$LINE_Type_Id_IN_DEVICE       - Devicename zur Verwendung mit Devices
                                         (inkl. Verzeichnispfad!)
COMCentre$LINE_Type_Id_IN_DEVICENAME   - Devicename zur Selektion
COMCentre$LINE_Type_Id_IN_USBINTERFACE - Bei USB-Geräten das Interface,
                                         was das Gerät implementiert
COMCentre$LINE_Type_Id_IN_USBINETINTERFACE - Bei USB-Geräten das Interface,
                                             was das Inetinterfces des Geräts implementiert

COMCentre$LINE_Type_Id_PT_IN      - Dateiname zum lesenden Zugriff auf das Gerät
COMCentre$LINE_Type_Id_PT_OUT     - Dateiname zum schreibenden Zugriff auf das Gerät
COMCentre$LINE_Type_Id_PT_INETIN  - Dateiname zum lesenden Zugriff auf das Gerät für
                                    Internetzugang
COMCentre$LINE_Type_Id_PT_INETOUT - Dateiname zum schreibenden Zugriff auf das Gerät für
                                    Internetzugang
COMCentre$LINE_Type_Id_PT_STATE   - Dateiname zum Zugriff auf asynchronen Meldungskanal
                                    des Gerätes, wenn vorhanden
COMCentre$LINE_Type_Id_PT_PPP     - Dateiname für PPP zum Zugriff auf das Gerät
COMCentre$LINE_Type_Id_PT_MIXED   - Dateiname zum lesenden Zugriff auf das Gerät, wenn
                                    Meldungskanal und normale Geräteausgabe gemischt.
                                    In diesem Fall startet ein Hilfsprogramm, was die
                                    MIXED-Daten auf zwei Pipe-Kanäle für PT_IN und
                                    PT_OUT aufteilt. Die beiden Pipes sind:
                                    - COMCentre.Type_Id_IN
                                    - COMCentre.Type_Id_STATE

COMCentre$LINE_Type_Id_CF_Parameter - Diverse Konfigurationsparameter

COMCentre$LINE_Type_OP_Op-Group_I_PREFERRED      - siehe Grundkonzept
COMCentre$[LINE_Type_Id_]OP_Op-Group_I_AVAILABLE - siehe Grundkonzept
COMCentre$LINE_Type_Id_OP_Op-Group_I_BUSY        - siehe Grundkonzept
COMCentre$LINE_Type_ID_OP_Op-Group_I_INITIALIZED - siehe Grundkonzept

COMCentre$[LINE_Type_Id_]OP_Op-Group_R_Op-Action - siehe Operationsaktionen

Verzeichnisse/Dateien
----------------------

!Boot   - RISC OS-Standard. Initialisiert inkl. Bereitstellung des
          COMCentre_register-Kommandos
!Help   - RISC OS-Standard. Liefert Hilfe
!Run    - RISC OS-Standard. Führt Initialisierung evt. bestehender Registrierungen
          durch.
Apps    - Enthält ein paar Programme für den Anwender
Devices - Enthält die Konfigurationsdateien für die einzelnen Geräte.
          Pro unterstütztem Gerät gibt es eine Datei namens
          PseudoHexVendorID_PseudoHexProductID
