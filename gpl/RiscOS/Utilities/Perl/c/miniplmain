/*
 * "The Road goes ever on and on, down from the door where it began."
 */

#include "INTERN.h"
#include "perl.h"

static void xs_init _((void));
static PerlInterpreter *my_perl;

#ifdef RISCOS
extern char * *  _make_environ(void);
#endif


int
main(int argc, char **argv)
{
#ifdef RISCOS
char ** env;
#else
    char *env[] = {"There","Is","No","Env","Array","ATM","Remind","Me","To","Fix","It",0};
#endif
    int exitstatus;

#ifdef VMS
    getredirection(&argc,&argv);
#endif

    if (!do_undump) {
	my_perl = perl_alloc();
	if (!my_perl)
	    exit(1);
	perl_construct( my_perl );
    }

#ifdef RISCOS
    env =  _make_environ();
#endif
    exitstatus = perl_parse( my_perl, xs_init, argc, argv, env );

#ifdef RISCOS /* THIS COULD BE DANGEROUS */
    free(env);
#endif
    if (exitstatus)
	exit( exitstatus );

    exitstatus = perl_run( my_perl );

    perl_destruct( my_perl );
    perl_free( my_perl );

    exit( exitstatus );
}

/* Register any extra external extensions */

static void
xs_init()
{
    /* Do not delete this line--writemain depends on it */
}
