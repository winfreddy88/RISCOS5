/* Copyright 2005 Castle Technology Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**************************************************************/
/* File:    Global.h                                          */
/*          (C) 2005 Tematic                                  */
/*          All rights reserved                               */
/*                                                            */
/* Purpose: Global inclusions and declarations.               */
/*                                                            */
/* Author:  A.D.Hodgkinson.                                   */
/*                                                            */
/* History: 18-Aug-2005 (ADH): Created.                       */
/**************************************************************/

#ifndef SCREENFX_GLOBAL_H
  #define SCREENFX_GLOBAL_H

  /* Standard headers */

  #include <stdlib.h>
  #include <stdint.h>
  #include <stdbool.h>
  #include <stdio.h>

  /* EventV and PaletteV constants */

  #include <Global/RISCOS.h>
  #include <Global/PaletteV.h>

  /* Custom library headers and macros */

  #ifdef DEBUGLIB
    #define TRACE
  #endif

  #include <swis.h>
  #include <debuglib/debuglib.h>

  #include <PRISMLib/Errors.h>
  #include <PRISMLib/Messages.h>

  /* Useful macros to help with debug printout */

  #define TOINT(i)  (uint32_t) (i)
  #define TOPTR(p)  ((p) == NULL ? 0        : (uint32_t) *(p))
  #define TOERR(e)  ((e) == NULL ? "<NULL>" : (e)->errmess)
  #define TOSTR(s)  ((s) == NULL ? "<NULL>" : (s))
  #define TOBOOL(b) ((b) == 0    ? "false"  : "true")

  /* Auto-generated headers */

  #include "VersionNum"
  #include "ScrFXHdr.h"

  /* Module's public API */

  #include "ScreenFX.h"

  /* Useful numbers */

  #define OsByte_DisableEvent             (0x0d)
  #define OsByte_EnableEvent              (0x0e)
  #define OsByte_WaitForVSync             (0x13)
  #define OsByte_ClearEscape              (0x7c)
  #define OsByte_ReadWriteEscapeKeyStatus (0xe5)

  /* Effect types */

  typedef enum screenfx_effect_type
  {
    screenfx_effect_type_NONE,
    screenfx_effect_type_FADE,
    screenfx_effect_type_CROSSFADE
  }
  screenfx_effect_type_t;

  /* RGBS programming tables for starting and current values */

  extern uint8_t   starting_table [1024];

  extern uint8_t * starting_r;
  extern uint8_t * starting_g;
  extern uint8_t * starting_b;
  extern uint8_t * starting_s;

  extern uint8_t   current_table  [1024];

  extern uint8_t * current_r;
  extern uint8_t * current_g;
  extern uint8_t * current_b;
  extern uint8_t * current_s;

  extern uint8_t   crossfade_hi   [256]; /* Array size of at least 256 is *assumed* globally */
  extern uint8_t   crossfade_lo   [256]; /* Array size of at least 256 is *assumed* globally */

  extern uint8_t * crossfade_start;
  extern uint8_t * crossfade_end;

  /* Fade effect information */

  extern volatile screenfx_effect_type_t fade_running;
  extern uint32_t                        fade_start_at;
  extern uint32_t                        fade_duration;
  extern bool                            fade_escaped;

  extern uint8_t                         fade_left_s;
  extern uint8_t                         fade_left_r;
  extern uint8_t                         fade_left_g;
  extern uint8_t                         fade_left_b;

  extern uint8_t                         fade_right_s;
  extern uint8_t                         fade_right_r;
  extern uint8_t                         fade_right_g;
  extern uint8_t                         fade_right_b;

#endif /* SCREENFX_GLOBAL_H */

/* End of file */
