| !Run file for Phoenix
| (C) Tematic 2006
|
| Last modified: 02/03/2006

Set      Phoenix$Dir          <Obey$Dir>

SetMacro Phoenix$Path         Choices:WWW.Phoenix.,<Phoenix$Dir>.,<Wimp$ScrapDir>.WWW.Phoenix.,<Phoenix$Dir>.User.
SetMacro Phoenix$ChoicesFile  Phoenix:Choices
SetMacro Phoenix$ControlsFile Phoenix:Controls
SetMacro Phoenix$ChoicesSave  <Choices$Write>.WWW.Phoenix.Choices

| URI handler support

Set Alias$Open_URI_http   <Phoenix$Dir>.!Run
Set Alias$Open_URI_ftp    <Phoenix$Dir>.!Run
Set Alias$Open_URI_gopher <Phoenix$Dir>.!Run

| Support the ANT URL protocol

SetMacro Alias$URLOpen_HTTP   Run <Phoenix$Dir>.!Run -url %%*0
SetMacro Alias$URLOpen_Gopher Run <Phoenix$Dir>.!Run -url %%*0
SetMacro Alias$URLOpen_File   Run <Phoenix$Dir>.!Run -url %%*0
SetMacro Alias$URLOpen_FTP    Run <Phoenix$Dir>.!Run -url %%*0

| Can't do much if we haven't got various key system resources...

If "<System$Path>"       = "" Then Set System$Path_Message System resources not found.
If "<InetDBase$Path>"    = "" Then Error Internet resources not found.
If "<Unicode$Path>"      = "" Then Error Unicode resources not found.
If "<Inet$MimeMappings>" = "" Then Set Inet$MimeMappings InetDBase:Mimemap

| For font choices, if someone else hasn't already set them up

If "<Font$Bold>"   = "" Then Set Font$Bold   "Bold Demi ExtraBold Ultra Heavy"
If "<Font$Italic>" = "" Then Set Font$Italic "Italic Oblique Slant"

| HTTP fetcher controls

Set Browse$AcceptAllCookies off
Set Browse$CookieFile       Phoenix:User.Cookies
Set Browse$CookieFileFormat 2

| Fundamental modules

RMEnsure WindowManager  3.98 Error Phoenix requires version 3.98 or later of the WindowManager ('nested WIMP') module

| Toolbox modules

<Phoenix$Dir>.RMTry -app Phoenix -name Toolbox      -version 1.43 -path System:Modules.Toolbox.Toolbox
<Phoenix$Dir>.RMTry -app Phoenix -name IconBar      -version 1.18 -path System:Modules.Toolbox.IconBar
<Phoenix$Dir>.RMTry -app Phoenix -name ProgInfo     -version 0.14 -path System:Modules.Toolbox.ProgInfo
<Phoenix$Dir>.RMTry -app Phoenix -name Window       -version 1.54 -path System:Modules.Toolbox.Window
<Phoenix$Dir>.RMTry -app Phoenix -name Menu         -version 0.33 -path System:Modules.Toolbox.Menu
<Phoenix$Dir>.RMTry -app Phoenix -name ToolAction   -version 0.15 -path System:Modules.Toolbox.ToolAction
<Phoenix$Dir>.RMTry -app Phoenix -name PrintDBox    -version 0.14 -path System:Modules.Toolbox.PrintDBox
<Phoenix$Dir>.RMTry -app Phoenix -name FontMenu     -version 0.21 -path System:Modules.Toolbox.FontMenu
<Phoenix$Dir>.RMTry -app Phoenix -name TextGadgets  -version 0.28 -path System:Modules.Toolbox.TextGadget
                                                    
| Fetchers
                                                    
<Phoenix$Dir>.RMTry -app Phoenix -name URL_Fetcher  -version 0.41 -path System:Modules.Network.URL.URL
<Phoenix$Dir>.RMTry -app Phoenix -name AcornHTTP    -version 0.84 -path System:Modules.Network.URL.HTTP
<Phoenix$Dir>.RMTry -app Phoenix -name FileFetcher  -version 0.38 -path System:Modules.Network.URL.File
<Phoenix$Dir>.RMTry -app Phoenix -name FTPFetcher   -version 0.32 -path System:Modules.Network.URL.FTP

| Other networking modules

<Phoenix$Dir>.RMTry -app Phoenix -name MimeMap      -version 0.05 -path System:Modules.Network.MimeMap

| General support modules

<Phoenix$Dir>.RMTry -app Phoenix -name DragAnObject -version 0.09 -path System:Modules.DragAnObj

| Try to get a new enough version of the URI handler. The module
| is not required, but its services will be used if available.

<Phoenix$Dir>.RMTry -silent -app Phoenix -name AcornURI -version 0.12 -path System:Modules.Network.URI

| The URI handler has a Wimp task side, so we want to do a
| '*Desktop' when inside the application after Wimp_Initialise
| to start it. Set a system variable if this is NOT needed.

Set Browse$IssueDesktopCommand "yes"
RMEnsure AcornURI 0.12 Set Browse$IssueDesktopCommand "no"

| JPEG support for OS versions without this in SpriteExtend.

RMEnsure SpriteExtend 0.99 RMEnsure JPEGMsgs   0.00 RMLoad System:Modules.JPEGMsgs
RMEnsure SpriteExtend 0.99 RMEnsure JPEGRender 0.00 RMLoad System:Modules.JPEGRender

| Routine actions...

Set Phoenix$Sprites "<Phoenix$Dir>.!Sprites"
If "<Boot$OSVersion>" >= "500" Then Set Phoenix$Sprites "<Phoenix$Dir>.5Sprites"
IconSprites <Phoenix$Sprites>

Set File$Type_FAF HTML
Set File$Type_F91 URI
Set File$Type_F81 JSScript
Set File$Type_695 GIF
Set File$Type_C85 JPEG
Set File$Type_B60 PNG

Set Alias$@RunType_FAF /<Phoenix$Dir>.!Run -html %%*0
Set Alias$@RunType_F91 /<Phoenix$Dir>.!Run -uri %%*0
Set Alias$@RunType_F81 /<Phoenix$Dir>.!Run -jss %%*0

| Set the slot size and run the application.

WimpSlot -Min 1280K -Max 1280K
Run <Phoenix$Dir>.!RunImage %*0
