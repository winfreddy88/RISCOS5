; Copyright 2002 Tematic Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
        GET     hdr.80321DMA
        GET     hdr.Audio
        GET     hdr.M1535DMA

        MACRO
        CallOS  $entry, $tailcall
        ASSERT  $entry <= HighestOSEntry
 [ "$tailcall"=""
        MOV     lr, pc
 |
   [ "$tailcall"<>"tailcall"
        ! 0, "Unrecognised parameter to CallOS"
   ]
 ]
        LDR     pc, OSentries + 4*$entry
        MEND

sb              RN      9

                ^       0
IIC_XStart      #       4       ; initial array pointer for transfer
IIC_XEnd        #       4       ; end pointer (inclusive)
IIC_XCurrent    #       4       ; current pointer
IIC_XBytes      #       4       ; bytes transferred in stage so far (inc addr, even if none)
IICTransferSize #       0

                ^       0,sb
OSheader        #       4
OSentries       #       4*(HighestOSEntry+1)
SpuriousIRQs1   #       4
SpuriousIRQs2   #       4
SpuriousIRQs3   #       4
SpuriousIRQs4   #       4
XINT0Masks      #       4
PMMR_Address    #       4
IO_Address      #       4
IOMD_Address    #       4
EASI_Address    #       4
PCI_Mem_Address #       4
PCI_IO_Address  #       4
DebugUART_Address #     4
IICTransferBlk0 #       IICTransferSize
IICTransferBlk1 #       IICTransferSize
IOSystemType    #       1       ; (for 665 debug podule)
MasterPICMask   #       1
SlavePICMask    #       1
UARTFCRSoftCopy #       1
PCIState        #       4       ; pointer to C PCI workspace
RTCDeviceStruct #       80
IDEDeviceStruct #       76+4
i80321DMAWS     #       i80321DMA_WorkspaceSize
M1535DMAWS      #       M1535DMA_WorkspaceSize
AudioWS         #       Audio_WorkspaceSize
AllocNext       #       4
NCNBWorkspace   #       4
NCNBAllocNext   #       4

                #       (((:INDEX:@)+15):AND::NOT:15)-(:INDEX:@)

AllocArea       #       64*1024

HAL_WsSize      *       :INDEX:@

                ^       0
NCNB_AllocArea  #       12*1024
NCNB_MUArea     #        4*1024
NCNB_MUQueue    #       16*1024

IOST_COMBOMASK  * 7
IOST_37C665     * 3

                END
