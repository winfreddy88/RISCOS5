/* Copyright 2004 Castle Technology Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**************************************************************/
/* File:    filter.h                                          */
/*                                                            */
/* Purpose: Functions that deal with claiming and releasing   */
/*          address filters.                                  */
/*                                                            */
/* Author:  J.R.Byrne.                                        */
/**************************************************************/

#ifndef EtherK_filter_h
#define EtherK_filter_h

/* Structures for holding a unit's filtering information */

typedef struct filtersingle
{
    uint32_t    fs_addrlevel;
    uint32_t    fs_errlevel;
    uint32_t    fs_pwptr;
    void        (*fs_handler)();
} FilterSingle, *FilterSingleRef;

typedef struct filterchain
{
    struct filterchain * fc_next;
    uint32_t             fc_type;
    FilterSingle         fc_filter;
} FilterChain, *FilterChainRef;

#define fc_addrlevel    fc_filter.fs_addrlevel
#define fc_errlevel     fc_filter.fs_errlevel
#define fc_pwptr        fc_filter.fs_pwptr
#define fc_handler      fc_filter.fs_handler

/* Typedef for pointer to filter function */

typedef int (*AddressFilter)(uint32_t level, uint8_t * pack_hdr, uint8_t * mac_addr);

/* Function prototypes */

int filter_update(_kernel_swi_regs * r, device_t dev);
void filter_release_module(device_t dev, uint32_t pwp);

#endif
